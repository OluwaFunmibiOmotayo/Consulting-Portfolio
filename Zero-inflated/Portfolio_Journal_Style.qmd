---
title: "A Hierarchical Zero-Inflated Gamma Analysis of Chemical Efficacy on Soil-Borne Pathogens in Soybean"
format:
  pdf:
    keep-tex: true
    documentclass: article
    papersize: letter
    fontsize: 10pt
    template-partials:
      - title.tex
      - before-bib.tex
      
    include-in-header:
      - text: |
          \usepackage{sdss2020}
          \usepackage{url}
          \usepackage{hyperref}
          \usepackage{latexsym}
          \usepackage{tabularx}
          \usepackage{amsmath, amsthm, amsfonts}
          \usepackage{algorithm, algorithmic}
          \usepackage[table,dvipsnames]{xcolor}
          \newcommand{\mt}[1]{{\textcolor{blue}{#1}}}
          \newcommand{\svp}[1]{{\textcolor{RedOrange}{#1}}}
    classoption: [twocolumn]
    mainfont: Times New Roman
    colorlinks: true

author:
  - name: Oluwafunmibi O. Fasanya
    affiliation:
      department: Department of Statistics
      institution: University of Nebraska–Lincoln
    email: ofasanya2@unl.edu
    corresponding: true

bibliography: references.bib
---

# Abstract

\vspace{-1em}

Soybean is a major food and oilseed crop which is valued for its high protein content and use in both human and livestock diets. Decrease in the yield of soybeans in the United States, particularly in Nebraska stirred the need to investigate the potential cause and effective management strategies. This study investigated the efficacy of chemical applications in controlling soil-borne pathogens of soybean and look at the tolerance of the various pathogens to fungicide at different dose level. Four fungal pathogens (Diaporthe longicolla, Fusarium oxysporum, Fusarium solani, and Rhizoctonia solani) were exposed to five fungicide treatments (De-laroComplete, Endura, Quadris, Topguard, and Topguard EQ) at various concentration levels in a growth medium (petri dish). The semicontinuous, positively skewed radial growth rate of pathogens were modelling using a zero-inflated gamma model with a split-plot design, withsplit-plot factor nested in whole-plot. Results showed effective fungal control depends on both selecting the right treatment and optimizing dose for the specific species involved.
*Keywords: Soybean, Fungicides, Soil-borne pathogens, Radial growth, Resistance*

# Project Reflection

\vspace{-1em}

On Thursday, February 13, from 11:45 AM to 1:00 PM, I had my initial meeting with my client Kelvin Muchiri. He is currently a Master's student working at the department of plant pathology and his advisor is Garcia-Aroca Teddy. He is interested in investigating the efficacy of chemical applications in controlling soil-borne pathogens of soybean.

The client indicated on the google form that they are interested in performing a two-way ANOVA and Tukey-HSD tests for their data on investigating the efficacy of chemical applications in controlling soil-borne pathogens of soybean. To be able to follow the prepare section of the POWER process, I mailed the client to ask for their dataset and some information on their previously done analysis prior to meeting since they indicated they have initially conducted some analysis on the data. This helped with getting prepared for our meeting and also helped implement the PREPARE stage of the power process.

During the open phase, we began by introducing ourselves and took some few minutes to establish rapport between myself and the domain expert. Also, before I asked them to give me a more detailed explanation of their project again, we briefly discussed their deadlines, their expectations and I also took the time to explain how I'm going to be helping on the project, after which we transitioned into the work phase. I believe this phase was quite helpful as it kind of set a collaborative and welcoming tone which made the domain expert feel more comfortable.

During the main part of the consultation, which is the work phase, I asked the domain expert to give me detailed explanation of how they conducted the experiment again as it would help me in determining the right approach to model their data. The domain expert ability to clearly provide a pictorial representation of their design was very helpful as it made me see exactly what was going on in their experiment. While describing his experiment, I noticed he had some nested structure he was not aware of and also his dataset contains a lot of zero's which he also was not bothered about. So I had to explain what a crossed and nested structure is and also asked more question about the information the zero-values were providing. The domain expert showed flexibility and willingness to collaborate, as they were open to suggestions with regards to analyzing their dataset in alignment with the way their experiment was designed. Their consistent engagement, insightful questions and calling my attention to explain what they do not understand reflected their trust in our expertise and a readiness to co-work with me on the analysis. After the initial meeting a document summarizing the experiment objectives and design was sent to the domain experts in order to be sure everyone is aware of the work we've gotten so far and so to ask some other questions that came up when I was reflecting on our meeting.

In general, I had an amazing experience working on this project with the domain-expert. Having the opportunity to collaborate directly with domain experts was a really great experience. I learned so much just listening to them explain their research approach and methodology. It was fascinating to see how they conducted their work in practice. Being part of a real-world project rather than just theoretical exercises really deepened my understanding and made the whole experience worthwhile.

# Introduction

\vspace{-1em}

Soybeans is a food and oilseed crop which is rich in both protein and edible oil. It is a major source of protein for both human and livestock but is prone to many disease that could cause a significant decrease in yield. As reported by @S_Navi2016 in their paper, in 2013, soybean was grown in 70 countries with an annual production of 268 million metric tons with United states (31%), Brazil (31%) and Argentina (19%) being the highest producer of soybeans. However, report from the USDA website showed that in 2024/2025 (Marketing Year 2024 from September -- August), Brazil is currently the largest producer of soybeans with about 169 million metric tons, followed by USA with about 118.84 million metric tons and the third largest producer is Argentina with 49 Million metric tons. The production from these three countries makes up 80% of the global population of soybeans around the world with 40% from Brazil, 28% from USA, and 12% from Argentina [@USA2025]. This reduction in yield of soybeans varies over the years as there are many factors that could affect grain yields and some of them include environment, production practices, and a variety's susceptibility to disease [@Allen2023]. In 2022, About 3 out of 4 the soybeans production in the United States comes from the northern states (Illinois, Indiana, Iowa, Kansas, Michigan, Minnesota, Nebraska, New York, North Dakota, Ohio, Pennsylvania, South Dakota, and Wisconsin) and all of these states jointly has a yield loss of 71.3% of the total soybeans loss in 2022. Seedling diseases due to Fusarium, Pythium, Phomopsis and Rhizoctonia are one of the major causes of soybeans loss in 2022 [@Allen2023]. Despite the advancements in soybean cultivation practices, plant pathogens continues to limit soybean yields. According to farm journal, the following soil-borne fungal pathogens (Fusarium, Rhizoctonia, Pythium, and Phytophthora) are some of the major causes of seedlings blights in soybeans and they are attributed to the loss of about 6 million bushels of soybeans in the United State and Canada in 2023 [@farmjournal2025]. Most of the crops in the United states are treated with fungide annually [@Gianessi_Reigner_2007].

In Nebraska, the largest producer of beef and pork, Soybeans is one of the major ingredient used in the beef and pork production. However, Nebraska experiences an estimated annual loss exceeding 9 million bushels due to pathogenic organisms [@Cropwatch]. According to @S_Navi2016, several fungal pathogens such as Colletotrichum truncatum, Fusarium virguliforme, Macrophomina phaseolina, Pythium irregulare, Rhizoctonia solani, and Sclerotinia sclerotiorum, are major contributors to soybean seedling diseases, which leads to decrease in soybeans yield. Their study evaluated the efficacy the following fungicides: Foliar fungicides picoxystrobin (Aproach®), fluoxastrobin (Evito), pyraclostrobin (Headline EC) and azoxystrobin (Quadris), pyraclostrobin + fluxapyroxad (Priaxor), trifloxystrobin + prothioconazole (Stratego YLD), and fluxapyroxad (Sercadis) on the following pathogens: Colletotrichum truncatum (CT), Fusarium virguliforme (FV), Macrophomina phaseolina (MP), Pythium irregulare (PI), Rhizoctonia solani (RS), Sclerotinia sclerotiorum (SS), Septoria glycines (SG) using an in vitro culture plug method. The result showed that, all of the fungicide except Sercadis reduced the growth of CT isolates. Headline EC, Priaxor, and Stratego YLD significantly reduced the growth of Fusarium virguliforme (FV), Macrophomina phaseolina (MP), Rhizoctonia solani (RS), and Sclerotinia sclerotiorum (SS). Sercadis was very effective against Rhizoctonia solani (RS) while Aproach and Quadris were effective against Fusarium virguliforme (FV) [@Altalb_2009] [@sang_2023]. The objective of this study is to investigate the efficacy of chemical applications in controlling soil-borne pathogens of soybean and to look at the tolerance of the various pathogens to fungicide at different dose level.

# Materials and Method

\vspace{-1em}

This experiment was conducted to determine the effectiveness of fungicides against soil-borne pathogens in soybeans. The fungicide was incorporated into the growth medium (petri dish) to ensure homogeneous distribution of this chemical across the different fungal species. To achieve this, data were collected based on the species of pathogens (isolates), different types of fungicide treatments, and at varying dose levels. This setup was designed to mimic how different fungicides would react with the pathogens in natural soil conditions.

## Experimental Design Details

\vspace{-1em}

The following isolates (species) were used in this study: Diaporthe longicolla, Fusarium oxysporum, Fusarium solani and Rhizoctonia solani. Also, the following fungicide was used: DelaroComplete 3 active ingr (Proth+Trif+Fluop), Endura 1 active ingredients (Boscalid), Quadris 1 active ingredients (Azoxystrobin), Topguard 1 active ingredient (Flutriafol), and Topguard EQ 2 active ingredient (Flut+Azoxys) Each of the fungicide treatments got 3 levels of doses (Dose in mg/ml) with one control. Each fungicide treatment had 3 levels of doses plus one control (no fungicide).

```{=tex}
\begin{table}[h!]
\scriptsize
\centering
\caption{Fungicide active ingredients and their dose levels (mg/ml).}
\begin{tabular}{|l|c|c|c|c|}
\hline
\textbf{Fungicide} & \textbf{Dose 1} & \textbf{Dose 2} & \textbf{Dose 3} & \textbf{Control} \\
\hline
Proth+Trif+Fluop & 6.292 & 0.6292 & 0.06292 & 0 \\
Boscalid & 4.011 & 0.4011 & 0.04011 & 0 \\
Azoxystrobin & 6.1036 & 0.61036 & 0.061036 & 0 \\
Flutriafol & 5.7975 & 0.57975 & 0.057975 & 0 \\
Flut+Azoxys & 4.9128 & 0.49128 & 0.049128 & 0 \\
\hline
\end{tabular}
\end{table}
```
**Response Variable:** Radial growth rate of pathogens was measured in the presence and absence (dose = 0) of fungicides. Each petri dish had 4 measurements (radial growth), which indicates that fungi often grow unevenly, so taking multiple measurements improves precision.

```{=tex}
\begin{table}[h!]
\scriptsize
\centering
\caption{Skeleton ANOVA (Split-Plot Factor Nested in Whole-plot factor)}
\begin{tabular}{|l|c|}
\hline
\textbf{Source of Variation} & \textbf{df} \\
\hline
Treatment & (5-1) = 4 \\
\hline
Dose(Treatment) & (4-1)*5 = 15 \\
\hline
Species & (4-1) = 3 \\
\hline
Treatment*Species & (5-1)*(4-1) = 12 \\
\hline
Species*Dose(Treatment) & 3*15 = 45 \\
\hline
Error(Dish(Dose*Species*Treatment)) & (3-1)*(4*4*5) = 160 \\
\hline
\end{tabular}
\end{table}
```
```{=tex}
The model specification is given as:
\begin{multline}
\text{Avg\_Measurement} = \text{Species} \times \text{Treatments} + \\
(1|\text{Dose:Treatments}) + (1|\text{Species:Dose:Treatments})
\end{multline}

Where:
\begin{itemize}
\setlength{\itemsep}{0pt}
\setlength{\parskip}{0pt}
\item \text{Species} \times \text{Treatments} is the fixed effects interaction which enables us to determine how different fungal species respond to different fungicide treatments.
\item (1|\text{Dose:Treatments}): This nested structure accounts for random variability due to different doses within each treatment.
\item (1|\text{Species:Dose:Treatments}): This nested structure accounts for the random variation in species responses within specific dose-treatment combinations.
\end{itemize}
```
## Two-Part Model (Zero-Inflated Gamma)

\vspace{-1em}

We model the growth of the fungus (mix of zero and positive values) using the two-part model as shown below: \begin{equation}
f(y) = (1 - \pi) I(y = 0) + \pi G_\theta(y| y > 0)
\end{equation} Where $\pi = logit(x\beta) = log (\frac{x\beta}{1-x\beta})$, representing the parameters used in modeling the probability of fungal growth greater than zero. $G_\theta(y| y > 0)$ follows a Gamma $(\alpha,\beta)$ distribution with $\alpha$ as the shape parameter, and $\beta$ as the scale parameter. The zero-inflated gamma distribution is given as ZIGamma$(\pi, \alpha,\beta)$, where $\pi$ is the probability that the fungus dies (y = 0), while $\alpha$ and $\beta$ provide information about the gamma distribution for the non-zero part of the model. For the zero-inflated gamma model, the probability that the fungus does not die is modeled using logistic regression, while the distribution of the non-zero growth is modelled using the gamma distribution with a log-link [@Mills2013] [@Wei_2019]. Figure 1 shows the histogram of the average fungal measurements. The distribution is right-skewed, with a high concentration of observations clustered at lower growth values.

![Average Radial growth by Treatment](Fig9.jpeg){fig-align="center" width="50%\""}

## Model Structure

\vspace{-1em}

This study used a zero-inflated Gamma model to examine the effects of species and treatments on the average fungal growth (positive continuous measurements with an excess of zeros), while also accounting for the nested structure of dose. This model was fitted using the `glmmTMB` package in R. - The nonzero part (positive fungal growth) was modelled using a Gamma distribution - The zero-inflated part which models the probability of an observation being structurally zero was modelled using a logistic regression. The gamma component consists of the main effect of species and treatment, interaction between species and treatment and Random effects for dose nested within treatment. The zero-inflated component includes only the intercept, assuming a constant probability of excess zeros across groups. \begin{equation}
Y_{ijkl} \sim \text{Zero inflated Gamma} (\pi_{ijkl}, \alpha, \beta), \text{where}
\end{equation}

-   $Log(E[Y_{ijkl}|Y_{ijkl} > 0]) = \mu + Species_i + Treatment_j + (Species \times Treatment)_{ij} + (1|Dose:Treatment) + (1|Species:Dose:Treatment)$
-   $Logit(\pi_{ijkl}) = \beta_0$
-   $\epsilon_{ijkl} \sim Gamma(\alpha, \beta)$

Where:

-   $Y_{ijkl}$ is the average measurement for the $i$th species, $j$th fungicide treatment, $k$th dose and $l$th dish
-   $\mu$ is the baseline log mean fungal growth
-   $\epsilon_{ijkl}$ is the overall error term
-   $\beta_0$ is the intercept for the zero-inflation model

## Exploratory Analysis

\vspace{-1em}

The individual measurement by treatments plot (Appendix) shows the distribution of fungal growth across different treatments. Since fungus spreads out like a circle as it grows, four measurements were taken: from the center to the top (measurement 1), center to the right (measurement 2), center to bottom (measurement 3), and center to the left (measurement 4). This figure shows that the mean growth across the various measurements was similar across directions, thus we took the average of the four values for each experimental unit. Figure 2 shows the average fungal growth across different treatments. Quadris 1 active ingredient has the highest average fungal growth followed by Endura 1 active ingredient, Topguard EQ 2 active ingredient, and Topguard 1 active ingredient.

![Average Radial growth by Treatment](Fig3.jpeg){fig-align="center" width="50%\""}

As also observed in the average measurements by treatment plot (appendix), Quadris 1 active ingredient (Azoxystrobin) showed the highest median fungal growth and the greatest variability, suggesting that this treatment was less effective in fungal control compared to the other treatments. Endura 1 active ingredient (Boscalid) had the next highest median growth but exhibited slightly less variability. Topguard 1 active ingredient (Flutriafol), Topguard EQ 2 active ingredients (Flutriafol + Azoxystrobin), and DelaroComplete 3 active ingredients (Prothioconazole + Trifloxystrobin + Fluopyram) had lower median fungal growth, which suggests better overall control of fungal spread.

Figure 3 shows the average fungal growth across species. Fusarium oxysporum grows the highest, followed by Rhizoctonia solani, Fusarium solani, and Diaporthe longicolla. Figure 6 confirms that Fusarium oxysporum has the highest growth under the experimental conditions, while Diaporthe longicolla has the least. Also, the individual measurement by treatments plot (Appendix) shows the distribution of fungal growth across different species. As observed in the average measurements by treatment plot (appendix), the mean growth across the various measurements was similar across directions.

![Average Radial growth by Species](Fig4.jpeg){fig-align="center" width="50%"}

Figure 4 shows the distribution of average fungal growth measurements across different fungicide dose levels, split by fungal species. For Diaporthe longicolla, the following doses: 6.292, 5.7975, 4.9128, 0.6292, 0.57975, 0.49128, 0.06292, and 0.057975, resulted in complete inhibition of fungal growth (growth = 0). For Fusarium solani, the doses of 6.292, 0.6292, and 0.06292 completely inhibited fungal development. However, Fusarium oxysporum showed resistance to fungicide treatments across all dose levels. Similar resistance was observed for Rhizoctonia solani.

![Fungal Growth by Dose and Species](Fig7.jpeg){fig-align="center" width="50%"}

Figure 5 shows the distribution of average fungal growth across different fungicide dose levels, split by fungicide treatment. This plot highlights the nested structure of dose within treatment. Across all treatments, fungal growth decreased with increasing fungicide dose levels. ![Fungal Growth by Dose and Treatment](Fig8.jpeg){fig-align="center" width="50%"}

# Advanced Analysis

\vspace{-1em}

The major goal of performing this experiment is to determine the effectiveness of fungicides against resistant pathogens.

## Random Effect Structure:

\vspace{-1em}

This part of the result shows the nested structure variability in both the conditional and the zero-inflated model.

Conditional Model Variance Components: These results show the variability in the pathogen growth for dose nested in treatment and for species crossed with treatment nested within dose. The variation in pathogen growth due to the random effect of dose nested within treatments is 0.3823, while the variation due to the random effect of species crossed with treatments nested within dose is 0.1007.

![Radial growth by Species](Fig10.png){fig-align="center" width="50%"}

## Fixed Effect Structure

\vspace{-1em}

The ANOVA table shows the effect of species, treatments, and their interaction for the gamma regression section of the zero-inflated model. The results indicate a marginally significant interaction between species and treatment (p \> 0.05). We investigated further to determine which treatment and species combinations differ in growth. Table 3 shows the interaction between fungal species and different treatments with respect to their average growth. The results revealed a statistically significant interaction between Fusarium oxysporum species and Azoxystrobin treatments (p = 0.0115).

![ANOVA for Fixed Effects](Fig11.png){fig-align="center" width="50%"}

```{=latex}
\begin{table*}[ht]
\centering
\caption{Interaction between Species and Treatments on Average Growth}
\renewcommand{\arraystretch}{1.2}
\begin{tabular}{|l|l|c|c|c|c|c|c|}
\hline
\rowcolor{gray!15} \textbf{Species} & \textbf{Treatments} & \textbf{df} & \textbf{Avg Growth} & \textbf{SE} & \textbf{LCL} & \textbf{UCL} & \textbf{p} \\
\hline
Diaporthe longicolla & \textit{(Proth+Trif+Fluop)} & 3 & 1.96 & 1.01 & 0.711 & 5.38 & 0.4564 \\
Fusarium oxysporum & \textit{(Proth+Trif+Fluop)} & 3 & 2.2 & 1.0 & 0.614 & 4.081 & 0.3657 \\
Fusarium solani & \textit{(Proth+Trif+Fluop)} & 3 & 1.2 & 0.618 & 0.435 & 3.29 & 0.8737 \\
Rhizoctonia solani & \textit{(Proth+Trif+Fluop)} & 3 & 2.05 & 0.778 & 0.975 & 4.31 & 0.3553 \\
\hline
Diaporthe longicolla & \textit{(Boscalid)} & 1 & 3.27 & 1.1 & 1.651 & 6.5 & 0.9614 \\
Fusarium oxysporum & \textit{(Boscalid)} & 1 & 6.52 & 1.31 & 3.255 & 10.65 & 0.1217 \\
Fusarium solani & \textit{(Boscalid)} & 1 & 5.63 & 1.3 & 2.85 & 10.2 & 0.1703 \\
Rhizoctonia solani & \textit{(Boscalid)} & 1 & 5.61 & 1.19 & 2.874 & 11.27 & 0.2824 \\
\hline
Diaporthe longicolla & \textit{(Azoxystrobin)} & 1 & 3.27 & 1.1 & 1.631 & 6.55 & 0.9614 \\
\rowcolor{yellow!30} Fusarium oxysporum & \textit{(Azoxystrobin)} & 1 & 9.9 & 3.51 & 4.941 & 19.83 & 0.0115 \\
Fusarium solani & \textit{(Azoxystrobin)} & 1 & 3.61 & 1.28 & 1.803 & 7.24 & 0.8737 \\
Rhizoctonia solani & \textit{(Azoxystrobin)} & 1 & 5.99 & 2.2 & 1.184 & 11.99 & 0.1632 \\
\hline
Diaporthe longicolla & \textit{(Flutriafol)} & 1 & 1.05 & 0.52 & 0.399 & 2.77 & 0.5177 \\
Fusarium oxysporum & \textit{(Flutriafol)} & 1 & 6.61 & 2.34 & 2.3 & 13.25 & 0.0894 \\
Fusarium solani & \textit{(Flutriafol)} & 1 & 3.9 & 0.77 & 2.03 & 6.4 & 0.3336 \\
Rhizoctonia solani & \textit{(Flutriafol)} & 1 & 1.92 & 0.646 & 0.905 & 4.04 & 0.2261 \\
\hline
Diaporthe longicolla & \textit{(Flut+Azoxys)} & 2 & 1.89 & 0.785 & 0.835 & 4.27 & 0.3336 \\
Fusarium oxysporum & \textit{(Flut+Azoxys)} & 2 & 2.87 & 0.84 & 1.184 & 4.75 & 0.0913 \\
Fusarium solani & \textit{(Flut+Azoxys)} & 2 & 3.01 & 0.87 & 1.055 & 6.05 & 0.1187 \\
Rhizoctonia solani & \textit{(Flut+Azoxys)} & 2 & 2.6 & 0.926 & 1.298 & 5.23 & 0.6934 \\
\hline
\end{tabular}
\end{table*}
```
Table 4 shows the significant pairwise comparisons between species and treatment combinations. Some key findings include:

-   Diaporthe longicolla showed 0.33 times lower average growth compared to Fusarium oxysporum under Azoxystrobin treatment
-   Fusarium oxysporum showed 2.741 times higher average growth compared to Fusarium solani under Azoxystrobin treatment
-   Fusarium oxysporum under Azoxystrobin treatment showed 9.412 times higher average growth compared to Diaporthe longicolla under Flutriafol treatment
-   Diaporthe longicolla growth was 0.159 times lower than Fusarium oxysporum growth under Flutriafol treatment
-   Fusarium oxysporum growth was 3.26 times greater than Fusarium solani growth when treated with Flutriafol

\vspace{0.1cm}

```{=latex}
\begin{table*}[ht]
\centering
\caption{Pairwise Differences in Fungal Growth Under Different Treatments}
\renewcommand{\arraystretch}{1.2}
\begin{tabular}{|p{8cm}|c|c|c|c|c|}
\hline
\rowcolor{gray!15} \textbf{Pairwise Comparison} & \textbf{Ratio} & \textbf{SE} & \textbf{LCL} & \textbf{UCL} & \textbf{p-value} \\
\hline
Diaporthe longicolla (Azoxystrobin) / Fusarium oxysporum (Azoxystrobin) & 0.33 & 0.081 & 0.1384 & 0.787 & 0.0011 \\
Fusarium oxysporum (Azoxystrobin) / Fusarium solani (Azoxystrobin) & 2.741 & 0.672 & 1.1489 & 6.537 & 0.0063 \\
Fusarium oxysporum (Azoxystrobin) / Diaporthe longicolla (Flutriafol) & 9.412 & 5.73 & 1.0886 & 81.381 & 0.0313 \\
Diaporthe longicolla (Flutriafol) / Fusarium oxysporum (Flutriafol) & 0.159 & 0.0674 & 0.0354 & 0.714 & 0.0024 \\
Fusarium oxysporum (Flutriafol) / Fusarium solani (Flutriafol) & 3.26 & 0.8 & 1.3664 & 7.776 & 0.0003 \\
Diaporthe longicolla (Flut+Azoxys) / Fusarium oxysporum (Flut+Azoxys) & 0.236 & 0.0773 & 0.0736 & 0.754 & 0.0018 \\
Fusarium oxysporum (Flut+Azoxys) / Fusarium solani (Flut+Azoxys) & 3.378 & 0.829 & 1.416 & 8.058 & 0.0001 \\
Fusarium oxysporum (Flut+Azoxys) / Rhizoctonia solani (Flut+Azoxys) & 3.075 & 0.759 & 1.2826 & 7.374 & 0.0009 \\
\hline
\end{tabular}
\end{table*}
```
Table 5 shows the Best Linear Unbiased Predictor (BLUP) for the random factor (dose nested within treatment). The BLUP result describes the effect of each level of the nested structure on average fungal growth. The value and sign describe the size and direction of the effect respectively. The result from the BLUP output below shows that the highest predicted fungal growth per each of the treatment was observed when dose was equal to zero. At dose = 0, the treatment DelaroComplete 3 active ingr (Proth+Trif+Fluop) has the highest predicted fungal growth (BLUP = 1.41), followed by Topguard 1 active ingr (Flutriafol) (BLUP = 0.98), Topguard EQ 2 active ingr (Flut+Azoxys) (BLUP = 0.92), Endura 1 active ingr (Boscalid) (BLUP = 0.46), and Quadris 1 active ingr (Azoxystrobin) (BLUP = 0.33). For DelaroComplete 3 active ingr (Proth+Trif+Fluop) treatment, increasing the dose showed a deceasing trend in the BLUP values, suggesting that higher doses for this treatment is associated with a reduced fungal growth. For Endura 1 active ingr (Boscalid), the predicted average growth at dose of 0.04011 is 0.13 i.e. the fungal are predicted to grow by 0.13 for the 0.04011: Boscalid dose treatment combination, however increasing the dosage to 0.4011 and 4.011 showed a decrease in the average growth of the fungal. For Quadris 1 active ingr (Azoxystrobin), Topguard 1 active ingr (Flutriafol), and Topguard EQ 2 active ingr (Flut+Azoxys), we also observed an increase in the predicted growth of fungus for the second dose level. However, the third and fourth level showed a decrease in the predicted growth of fungus.

![Fungal Growth by Dose and Treatment](Fig18.jpeg){fig-align="center" width="50%"}

A Best Linear Unbiased Prediction (BLUP) was conducted to estimate the random effects of Species crossed with Dose nested within Treatment, on fungal growth (Table 6). For Diaporthe Logicolla, increasing growth was predicted for high dose of Endura 1 active, and Quadris 1 active, low dose of Topguard EQ2 and medium dose of Quadris 1 active. Stable growth was predicted for high and medium dose of Delarocomplete, Topguard 1 active, Topguard EQ 1, low and control dose of Delarocomplete and Toguard 1 active. Other dose treatment combination for this species saw a decreasing growth. Here, the DelaroComplete (Proth+Trif+Fluop) and Topguard (Flutriafol) treatment showed little decrease with values close to zero in BLUP estimates for dose 0 while for other dose, fungus growth neither increase nor decrease. This suggests that fungal growth under this treatment remained relatively stable when the dose was increased. Endura (Boscalid) showed the highest positive BLUP at dose 4.011 (BLUP = 0.298), indicating increased fungal growth at this dose compared to lower concentrations. However, at lower doses (0.00, 0.04011 and 0.4011), the BLUP estimates were negative, suggesting a decrease in fungal growth. Quadris (Azoxystrobin) demonstrated negative BLUP estimates at lower doses (BLUP = -0.282 at dose 0 and -0.063 at dose 0.061) but increased at higher doses (BLUP = 0.12 and 0.22 at 0.61036 and 6.1036 respectively). For Topguard EQ (Flut+Azoxys), the prediction showed that fungal growth reduced at dose 0, predicted increase in growth by 0.265 at dose 0.049128 while at dose 0.49128 and 4.9128, there fungus growth neither increase nor decrease.

For Fusarium oxysporum, increasing growth was predicted for high dose of Topguard 1 active, Quadris 1 active, Topguard EQ 2, control dose for Endura 1 active and Delarocomplete, medium dose for Topguard 1 active, Quadris 1 active, Topguard EQ 2 active, low dose for Delarocomplete, Topguard EQ 2 active, andEndura 1 active. Other dose treatment combination for this species saw a decreasing growth. For Fusarium oxysporum species treated with DelaroComplete 3 active ingr (Proth+Trif+Fluop) and Quadris 1 active ingr (Azoxystrobin), the Best Linear Unbiased Prediction result showed an increase in fungus growth for the first two dose while the fungus growth reduced for the other dose. For Fusarium oxysporum species treated with Endura 1 active ingr (Boscalid), the Best Linear Unbiased Prediction result showed an increase in fungus growth for the first three dose (0.0, 0.04011, and 0.4011) while it predicted a reduction in the growth of fungus for dose 4.011. For Fusarium oxysporum species treated Topguard 1 active ingr (Flutriafol), BLUP predicted a decrease in growth for dose level 0 and 0.057975 while the other two level is predicted to increase growth in this specie. For Fusarium oxysporum species treated with Topguard EQ 2 active ingr (Flut+Azoxys), the Best Linear Unbiased Prediction result showed an increase in fungus growth for dose 0.049128 and 4.9128 while the other two dose were predicted to reduce growth of fungus.

For Fusarium Solani, increasing growth was predicted for high and medium dose of Quadris 1 active, medium dose for Endura 1 active, and Topguard EQ 2, low dose for Topguard 1 active, Topguard Eq 2 active, and Endura 1 active. Stable growth was predicted for high, medium, lowand control dose of Delarocomplete. Other dose treatment combination for this species saw a decreasing growth. For Fusarium solani species treated with DelaroComplete 3 active ingr (Proth+Trif+Fluop), dose 0 showed a reduction in growth while the other dose level showed a zero growth. For Fusarium solani species treated with Endura 1 active ingr (Boscalid), dose 0 and 4.011 showed a reduction in growth while BLUP predicted an increase in growth for dose 0.04011, and 0.4011. For Fusarium solani species treated with Topguard 1 active ingr (Flutriafol), BLUP predicted a reduction in growth at dose 0, 0.57975, and 5.7975 while growth was predicted to increase at dose level 0.057975. For Fusarium solani species treated with Topguard EQ 2 active ingr (Flut+Azoxys), dose 0 and 4.9128 showed a reduction in growth while BLUP predicted an increase in growth for dose 0.049128, and 0.49128.

For Rhizoctonia solani, increasing growth was predicted for control dose of Topguard EQ 2, Topguard 1 active, Quadris 1 active , Delarocomplete, and Endura 1 active, low dose of Quadris 1 active and Endura 1 active, high dose of Delarocomplete, Topguard EQ 2, and Endura 1 active. Stable growth was predicted for medium Delarocomplete. Other dose treatment combination for this species saw a decreasing growth. For Rhizoctonia solani species treated with DelaroComplete 3 active ingr (Proth+Trif+Fluop) , BLUP showed that dose 0 and 6.292 increased the fungus growth, dose 0.06292 reduced the fungus growth while dose 0.6292 neither increased nor decrease the growth of fungus. With Endura 1 active ingr (Boscalid) treatment, dose 0.4011 was predicted to reduce the growth of fungus while the other dose level increased fungus growth. For Quadris 1 active ingr (Azoxystrobin) treatment, dose 0 and 0.061036 increased fungus growth while the other two dose was predicted to reduce dose. For Topguard 1 active ingr (Flutriafol), dose 0 and 5.7975 was predicted to increase fungus growth, while other dose level decreased the growth of fungus. With Topguard EQ 2 active ingr (Flut+Azoxys), dose 0 and 4.9128 increased the growth of fungus while dose 0.049128 and 0.49128 was predicted to reduce their growth.

![Fungal Growth by Dose and Treatment](Fig21.jpeg){fig-align="center" width="50%"}

# Conclusion

\vspace{-1em}

F. oxysporum differed significantly in growth response compared to species: F. solani, D. longicolla, R. solani) under the following treatment Quadris 1 active (Azoxystrobin), Topguard 1 active (Flutriafol), and Topguard EQ 2 active (Flut+Azoxys). At control dose, delarocomplete treatment has the highest growth, followed by Topguard 1 active, Topguard EQ 2 active, Endura 1 active, Quadris 1 active. Topguard 1 active, Topguard EQ 2 active, Endura 1 active, Quadris 1 active continued to grow at low dose but delarocomplete decreased in growth. For species crossed with dose nested in treatments, responses varied by species and fungicide, indicating strong species-specific interaction patterns. Notable differences for F. oxysporum, which showed variable trends depending on treatment and dose. Overall, effective fungal control depends on both selecting the right treatment and optimizing dose for the specific species involved.

# References

::: {#refs}
:::

```{=latex}
\clearpage
\nocite{*}
\twocolumn[\section*{Appendix I}]
```
![Radial growth by Treatment](Fig1.jpeg){fig-align="center" width="45%"} \vspace{0.1cm} ![Radial growth by Species](Fig2.jpeg){fig-align="center" width="45%"} \vspace{0.1cm} ![Average Radial growth by Treatment](Fig5.jpeg){fig-align="center" width="45%"} \vspace{0.1cm} ![Average Radial growth by Species (Boxplot)](Fig6.jpeg){fig-align="center" width="45%"} \vspace{0.1cm}

```{=latex}
\begin{table}[ht]
\centering
\small
\caption{Best Linear Unbiased Prediction for Dose nested within Treatment}
\renewcommand{\arraystretch}{1.2}
\begin{tabular}{|p{7.0cm}|r|}
\hline
\textbf{Dose:Treatment} & \textbf{BLUP} \\
\hline
0:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & 1.4118 \\
0.06292:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & -0.2938 \\
0.6292:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & -0.6315 \\
6.292:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & -0.5171 \\
0:Endura 1 active \textit{(Boscalid)} & 0.4644 \\
0.04011:Endura 1 active \textit{(Boscalid)} & 0.1312 \\
0.4011:Endura 1 active \textit{(Boscalid)} & -0.0614 \\
4.011:Endura 1 active \textit{(Boscalid)} & -0.5659 \\
0:Quadris 1 active \textit{(Azoxystrobin)} & 0.3327 \\
0.061036:Quadris 1 active \textit{(Azoxystrobin)} & 0.1095 \\
0.61036:Quadris 1 active \textit{(Azoxystrobin)} & -0.0933 \\
6.1036:Quadris 1 active \textit{(Azoxystrobin)} & -0.3806 \\
0:Topguard 1 active \textit{(Flutriafol)} & 0.9781 \\
0.057975:Topguard 1 active \textit{(Flutriafol)} & 0.3181 \\
0.57975:Topguard 1 active \textit{(Flutriafol)} & -0.5203 \\
5.7975:Topguard 1 active \textit{(Flutriafol)} & -0.8084 \\
0:Topguard EQ 2 active \textit{(Flut+Azoxys)} & 0.9204 \\
0.049128:Topguard EQ 2 active \textit{(Flut+Azoxys)} & 0.0501 \\
0.49128:Topguard EQ 2 active \textit{(Flut+Azoxys)} & -0.4068 \\
4.9128:Topguard EQ 2 active \textit{(Flut+Azoxys)} & -0.5986 \\
\hline
\end{tabular}
\end{table}
```
\vspace{0.1cm}

```{=latex}
\begin{table}[ht]
\centering
\small
\caption{Best Linear Unbiased Prediction for Dose nested within Treatment for Diaporthe longicolla }
\renewcommand{\arraystretch}{1.2}
\begin{tabular}{|p{6.4cm}|r|}
\hline
\textbf{Dose:Treatment} & \textbf{BLUP} \\
\hline
0:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & -0.000616511 \\
0.06292:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & 0 \\
0.6292:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & 0 \\
6.292:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & 0 \\
0:Endura 1 active \textit{(Boscalid)} & -0.041562794 \\
0.04011:Endura 1 active \textit{(Boscalid)} & -0.237818396 \\
0.4011:Endura 1 active \textit{(Boscalid)} & -0.021039568 \\
4.011:Endura 1 active \textit{(Boscalid)} & 0.298317876 \\
0:Quadris 1 active \textit{(Azoxystrobin)} & -0.282390186 \\
0.061036:Quadris 1 active \textit{(Azoxystrobin)} & -0.062961318 \\
0.61036:Quadris 1 active \textit{(Azoxystrobin)} & 0.121451677 \\
6.1036:Quadris 1 active \textit{(Azoxystrobin)} & 0.221821793 \\
0:Topguard 1 active \textit{(Flutriafol)} & -0.000574947 \\
0.057975:Topguard 1 active \textit{(Flutriafol)} & 0 \\
0.57975:Topguard 1 active \textit{(Flutriafol)} & 0 \\
5.7975:Topguard 1 active \textit{(Flutriafol)} & 0 \\
0:Topguard EQ 2 active \textit{(Flut+Azoxys)} & -0.271722003 \\
0.049128:Topguard EQ 2 active \textit{(Flut+Azoxys)} & 0.265117379 \\
0.49128:Topguard EQ 2 active \textit{(Flut+Azoxys)} & 0 \\
4.9128:Topguard EQ 2 active \textit{(Flut+Azoxys)} & 0 \\
\hline
\end{tabular}
\end{table}
```
\vspace{0.1cm}

```{=latex}
\begin{table}[ht]
\centering
\small
\caption{Best Linear Unbiased Prediction for Dose nested within Treatment for Fusarium oxysporum }
\renewcommand{\arraystretch}{1.2}
\begin{tabular}{|p{6.4cm}|r|}
\hline
\textbf{Dose:Treatment} & \textbf{BLUP} \\
\hline
0:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & 0.106100059 \\
0.06292:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & 0.355692318\\
0.6292:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & -0.166327429 \\
6.292:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & -0.299732171 \\
0:Endura 1 active \textit{(Boscalid)} & 0.278496151 \\
0.04011:Endura 1 active \textit{(Boscalid)} & 0.136230476 \\
0.4011:Endura 1 active \textit{(Boscalid)} & 0.019989513 \\
4.011:Endura 1 active \textit{(Boscalid)} & -0.436805234 \\
0:Quadris 1 active \textit{(Azoxystrobin)} & -0.129392723 \\
0.061036:Quadris 1 active \textit{(Azoxystrobin)} & -0.034205375 \\
0.61036:Quadris 1 active \textit{(Azoxystrobin)} & 0.128827724 \\
6.1036:Quadris 1 active \textit{(Azoxystrobin)} & 0.032736257 \\
0:Topguard 1 active \textit{(Flutriafol)} & -0.268141692 \\
0.057975:Topguard 1 active \textit{(Flutriafol)} & -0.017637166 \\
0.57975:Topguard 1 active \textit{(Flutriafol)} & 0.200686125 \\
5.7975:Topguard 1 active \textit{(Flutriafol)} & 0.083511652 \\
0:Topguard EQ 2 active \textit{(Flut+Azoxys)} & -0.153415918 \\
0.049128:Topguard EQ 2 active \textit{(Flut+Azoxys)} & 0.164391125 \\
0.49128:Topguard EQ 2 active \textit{(Flut+Azoxys)} & -0.014750217 \\
4.9128:Topguard EQ 2 active \textit{(Flut+Azoxys)} & 0.004023557 \\
\hline
\end{tabular}
\end{table}
```
\vspace{0.1cm}

```{=latex}
\begin{table}[ht]
\centering
\small
\caption{Best Linear Unbiased Prediction for Dose nested within Treatment for Fusarium solani }
\renewcommand{\arraystretch}{1.2}
\begin{tabular}{|p{6.4cm}|r|}
\hline
\textbf{Dose:Treatment} & \textbf{BLUP} \\
\hline
0:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & -0.000625527 \\
0.06292:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & 0\\
0.6292:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & 0 \\
6.292:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & 0 \\
0:Endura 1 active \textit{(Boscalid)} & -0.13874485 \\
0.04011:Endura 1 active \textit{(Boscalid)} & 0.110523464 \\
0.4011:Endura 1 active \textit{(Boscalid)} & 0.080927519 \\
4.011:Endura 1 active \textit{(Boscalid)} & -0.05479903 \\
0:Quadris 1 active \textit{(Azoxystrobin)} & -0.088966249 \\
0.061036:Quadris 1 active \textit{(Azoxystrobin)} & -0.04005418 \\
0.61036:Quadris 1 active \textit{(Azoxystrobin)} & 0.078676058 \\
6.1036:Quadris 1 active \textit{(Azoxystrobin)} & 0.048275351 \\
0:Topguard 1 active \textit{(Flutriafol)} & -0.062226152\\
0.057975:Topguard 1 active \textit{(Flutriafol)} & 0.308842891 \\
0.57975:Topguard 1 active \textit{(Flutriafol)} & -0.158526749 \\
5.7975:Topguard 1 active \textit{(Flutriafol)} & -0.089786457 \\
0:Topguard EQ 2 active \textit{(Flut+Azoxys)} & -0.160570939 \\
0.049128:Topguard EQ 2 active \textit{(Flut+Azoxys)} & 0.272726683 \\
0.49128:Topguard EQ 2 active \textit{(Flut+Azoxys)} & 0.124419505 \\
4.9128:Topguard EQ 2 active \textit{(Flut+Azoxys)} & -0.236335868 \\
\hline
\end{tabular}
\end{table}
```
\vspace{0.1cm}

```{=latex}
\begin{table}[ht]
\centering
\small
\caption{Best Linear Unbiased Prediction for Dose nested within Treatment for Rhizoctonia solani }
\renewcommand{\arraystretch}{1.2}
\begin{tabular}{|p{6.4cm}|r|}
\hline
\textbf{Dose:Treatment} & \textbf{BLUP} \\
\hline
0:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & 0.266911298 \\
0.06292:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & -0.433046666\\
0.6292:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & 0 \\
6.292:DelaroComplete 3 active \textit{(Proth+Trif+Fluop)} & 0.163567614 \\
0:Endura 1 active \textit{(Boscalid)} & 0.02410454 \\
0.04011:Endura 1 active \textit{(Boscalid)} & 0.025606511 \\
0.4011:Endura 1 active \textit{(Boscalid)} & -0.09605766 \\
4.011:Endura 1 active \textit{(Boscalid)} & 0.044278398 \\
0:Quadris 1 active \textit{(Azoxystrobin)} & 0.588356584 \\
0.061036:Quadris 1 active \textit{(Azoxystrobin)} & 0.166050995 \\
0.61036:Quadris 1 active \textit{(Azoxystrobin)} & -0.353527076 \\
6.1036:Quadris 1 active \textit{(Azoxystrobin)} & -0.403055423 \\
0:Topguard 1 active \textit{(Flutriafol)} & 0.588507333\\
0.057975:Topguard 1 active \textit{(Flutriafol)} & -0.20745378 \\
0.57975:Topguard 1 active \textit{(Flutriafol)} & -0.179171739 \\
5.7975:Topguard 1 active \textit{(Flutriafol)} & -0.206618072 \\
0:Topguard EQ 2 active \textit{(Flut+Azoxys)} & 0.828083859\\
0.049128:Topguard EQ 2 active \textit{(Flut+Azoxys)} & -0.689032837 \\
0.49128:Topguard EQ 2 active \textit{(Flut+Azoxys)} & -0.216787688 \\
4.9128:Topguard EQ 2 active \textit{(Flut+Azoxys)} & 0.074685212 \\
\hline
\end{tabular}
\end{table}
```
<!-- ```{=latex} -->

<!-- \clearpage -->

<!-- \onecolumn -->

<!-- \section*{Appendix II}] -->

<!-- \begin{footnotesize} -->

<!-- ``` -->

```{=latex}
\clearpage
\nocite{*}
\onecolumn
\section*{Appendix II}
\scriptsize
```
```{r}
#| eval: false
#| echo: true

library(readr)
library(dplyr)
library(car)
library(lme4)
library(glmmTMB)
library(tidyr)
library(ggplot2)
library(stringr)
library(forcats)
library(tidyr)
library(patchwork)

#Data Import
Fungicide_Data <- read_csv("Fungicide Exp 5 Design.csv")
View(Fungicide_Data)

str(Fungicide_Data)


# Pivot the measurement columns into long format
Fungicide_long <- Fungicide_Data %>%
  pivot_longer(cols = starts_with("Measurement"), 
               names_to = "Measurement_Number", 
               values_to = "Measurement_Value") %>%
  filter(!is.na(Measurement_Value))  # Remove missing values if needed

# Quick check
head(Fungicide_long)


# Summarize if needed
fungicide_summary_long <- Fungicide_long %>%
  group_by(Treatments, Measurement_Number) %>%
  summarise(Avg_Length = mean(Measurement_Value, na.rm = TRUE)) %>%
  ungroup()

# Plot
ggplot(fungicide_summary_long, aes(x = Treatments, y = Avg_Length, fill = Measurement_Number)) +
  geom_bar(stat = "identity", position = "dodge") +  # You can also try position = "stack"
  coord_polar(start = 0) +
  ylim(0, max(fungicide_summary_long$Avg_Length) * 1.5) +
  theme_minimal() +
  theme(
    axis.text.y = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    legend.position = "right"
  ) +
  labs(fill = "Measurement", title = "Individual Measurements by Treatment")

fungicide_summary_long2 <- Fungicide_long %>%
  group_by(Species, Measurement_Number) %>%
  summarise(Avg_Length = mean(Measurement_Value, na.rm = TRUE)) %>%
  ungroup()

ggplot(fungicide_summary_long2, aes(x = Species, y = Avg_Length, fill = Measurement_Number)) +
  geom_bar(stat = "identity", position = "dodge") +  # You can also try position = "stack"
  coord_polar(start = 0) +
  ylim(0, max(fungicide_summary_long$Avg_Length) * 1.5) +
  theme_minimal() +
  theme(
    axis.text.y = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    legend.position = "right"
  ) +
  labs(fill = "Measurement", title = "Individual Measurements by Species")


Fungicide_Data$Avg_Measurement <- rowMeans(Fungicide_Data[,c("Measurement 1","Measurement 2", "Measurement 3","Measurement 4")], na.rm = TRUE)
summary(Fungicide_Data$Avg_Measurement)

Fungicide_Data[is.na(Fungicide_Data$Avg_Measurement),]
Fungicide_Data <- Fungicide_Data[!is.na(Fungicide_Data$Avg_Measurement), ]


# Remove the four measurement columns
Fungicide_Data <- Fungicide_Data[, !(names(Fungicide_Data) %in% c("Measurement 1", "Measurement 2", "Measurement 3", "Measurement 4","Comments","Dates"))]
str(Fungicide_Data)


# Rename variables
Fungicide_Data <- Fungicide_Data %>% rename(Dose = ...10)

#Converting to a Factor
Fungicide_Data <- Fungicide_Data %>%
  mutate(
    Species = as.factor(Species),
    Isolates = as.factor(Isolates),
    Treatments = as.factor(Treatments),
    Dilution = as.factor(Dilution),
    techRep = as.factor(techRep),
    Exp_Code = as.factor(Exp_Code),
    Dose = as.factor(Dose)
  )

# Check the structure of the dataset
str(Fungicide_Data)
summary(Fungicide_Data)

#######################################Exploratory Data Analysis#########################################################
hist(Fungicide_Data$Avg_Measurement, 
     breaks = 30, 
     main = "Histogram of Average Fungal Measurement",
     xlab = "Average Measurement",
     col = "skyblue")

ggplot(Fungicide_Data, aes(x = Species, y = Avg_Measurement)) +
  geom_boxplot(fill = "skyblue") +
  theme_minimal() +   #white background
  labs(title = "Avg Measurement by Species",
       x = "Species",
       y = "Average Measurement")

ggplot(Fungicide_Data, aes(x = Treatments, y = Avg_Measurement)) +
  geom_boxplot(fill = "lightpink") +
  theme_minimal() +   #white background
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(title = "Avg Measurement by Treatment",
       x = "Treatment",
       y = "Average Measurement")


# summarize Avg_Measurement for each Treatment
fungicide_summary <- Fungicide_Data %>%
  group_by(Treatments) %>%
  summarise(Avg_Length = mean(Avg_Measurement, na.rm = TRUE)) %>%
  arrange(desc(Avg_Length))

# Create a circular bar plot
ggplot(fungicide_summary, aes(x = Treatments, y = Avg_Length, fill = Treatments)) +
  geom_bar(stat = "identity") +
  coord_polar(start = 0) +
  theme_minimal() +
  theme(
    axis.text.y = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    legend.position = "right"
  ) +
  labs(fill = "Treatment Type", title = "Average Measurement by Treatment")


# summarize Avg_Measurement for each Species
fungicide_summary <- Fungicide_Data %>%
  group_by(Species) %>%
  summarise(Avg_Length = mean(Avg_Measurement, na.rm = TRUE)) %>%
  arrange(desc(Avg_Length))

# Create a circular bar plot
ggplot(fungicide_summary, aes(x = Species, y = Avg_Length, fill = Species)) +
  geom_bar(stat = "identity") +
  coord_polar(start = 0) +
  theme_minimal() +
  theme(
    axis.text.y = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    legend.position = "right"
  ) +
  labs(fill = "Species", title = "Average Measurement by Species")

library(ggplot2)

ggplot(Fungicide_Data, aes(x = Species, y = Avg_Measurement, color = Dose)) +
  geom_point(position = position_jitter(width = 0.2), size = 2) +
  facet_wrap(~ Treatments) +
  theme_minimal() +
  labs(title = "Species Crossed with Dose within Treatments",
       x = "Species",
       y = "Average Measurement") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) # tilt x labels if Species names are long

ggplot(Fungicide_Data, aes(x = Species, y = Avg_Measurement, fill = Dose)) +
  geom_boxplot() +
  facet_wrap(~ Treatments) +
  theme_minimal() +
  labs(title = "Dose Nested within Species across Treatments",
       x = "Dose",
       y = "Average Measurement") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

library(ggplot2)

ggplot(Fungicide_Data, aes(x = Species, y = Avg_Measurement, fill = Dose)) +
  geom_boxplot() +
  facet_wrap(~ Treatments, scales = "free_x") +  # allow x-axis to adjust for each Treatment
  theme_minimal() +
  labs(title = "Dose Nested within Species across Treatments",
       x = "Species",  # Corrected x label
       y = "Average Measurement") +
  theme(
    strip.background = element_rect(color = "black", fill = "gray90", size = 1.5), # thicker facet strip border
    panel.spacing = unit(1, "lines"),  # more space between panels
    panel.border = element_rect(color = "black", fill = NA, size = 1.2),  # visible black border around each panel
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

ggplot(Fungicide_Data, aes(x = Species, y = Avg_Measurement, fill = Dose)) +
  geom_boxplot(position = position_dodge(width = 0.8)) +
  facet_wrap(~ Treatments) +
  theme_minimal() +
  labs(title = "Average Measurement across Species, Doses, and Treatments",
       x = "Species",
       y = "Average Measurement") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


ggplot(Fungicide_Data, aes(x = Avg_Measurement, y = Dose, fill = Dose)) +
  geom_boxplot(alpha = 0.7, outlier.shape = NA, color = "black") +  # <-- add color = "black"
  geom_jitter(height = 0.2, alpha = 0.5, color = "black") +
  facet_wrap(~Species) +
  labs(x = "Average Measurement", y = "Dose Group", fill = "Dose") +
  theme_bw() +  # still using white background
  theme(legend.position = "none")

ggplot(Fungicide_Data, aes(x = Avg_Measurement, y = Dose, fill = Dose)) +
  geom_boxplot(alpha = 0.7, outlier.shape = NA, color = "black") +  # <-- add color = "black"
  geom_jitter(height = 0.2, alpha = 0.5, color = "black") +
  facet_wrap(~Treatments) +
  labs(x = "Average Measurement", y = "Dose Group", fill = "Dose") +
  theme_bw() +  # still using white background
  theme(legend.position = "none")


#Proportion of Zero
library(skimr)
skim(Fungicide_Data$Avg_Measurement)

percentage_zeros <- sum(Fungicide_Data$Avg_Measurement == 0, na.rm = TRUE) / nrow(Fungicide_Data) * 100
print(percentage_zeros)

#Distribution of Species and treatments
table(Fungicide_Data$Species)
table(Fungicide_Data$Treatments)


# Check if any groups have complete separation
table(Fungicide_Data$Species, Fungicide_Data$Avg_Measurement > 0)
table(Fungicide_Data$Treatments, Fungicide_Data$Avg_Measurement > 0)

#Cross Tabulation of Species and Treatments
table(Fungicide_Data$Species, Fungicide_Data$Treatments)

table(Fungicide_Data$Treatments, Fungicide_Data$Dose)


###################################################################################################################################
#Normal Distribution
###################################################################################################################################
library(lme4)
library(emmeans)
model1 <- lmer(Avg_Measurement ~ Species * Treatments + 
                 (1 | Dose:Treatments) + (1 | Species:Dose:Treatments), 
               data = Fungicide_Data)

# ANOVA Table
summary(model1)

car::Anova(model1, type = 3)

# Pairwise Comparisons (Tukey-adjusted)
emmeans(model1, pairwise ~ Treatments, adjust = "tukey")
emmeans(model1, pairwise ~ Species, adjust = "tukey")
emmeans(model1, pairwise ~ Treatments | Species, adjust = "tukey")
emmeans(model1, pairwise ~ Treatments * Species, adjust = "tukey")

###################################################################################################################################

#####################################################################################################################################################
# Model diagnostics
#####################################################################################################################################################
plot(model1)

par(mfrow = c(2,2))

#Normality of residuals

# QQ plot
qqnorm(residuals(model1))
qqline(residuals(model1))

# Histogram of residuals
hist(residuals(model1))

# Shapiro-Wilk test
shapiro.test(residuals(model1))

#Homogeneity of variance

# Plot residuals vs fitted values
plot(fitted(model1), residuals(model1))
abline(h=0, col="red")

# Check for influential observations
# Cook's distance plot
plot(cooks.distance(model1))

# 3. Independence and Homogeneity
# Plot residuals vs each predictor
plot(residuals(model1) ~ Fungicide_Data$Treatments)
plot(residuals(model1) ~ Fungicide_Data$Species)

par(mfrow = c(1,1))
###################################################################################################################################

#####################################################################################################################################
# Normal Distribution on Filtered Data
#####################################################################################################################################
Fungicide_filtered <- subset(Fungicide_Data, Avg_Measurement > 0)

model2 <- lmer(Avg_Measurement ~ Species * Treatments + 
                 (1 | Dose:Treatments) + (1 | Species:Dose:Treatments), 
               data = Fungicide_filtered)
summary(model2)

car::Anova(model1, type = 3)

# Pairwise Comparisons (Tukey-adjusted)
emmeans(model2, pairwise ~ Treatments, adjust = "tukey")
emmeans(model1, pairwise ~ Species, adjust = "tukey")
emmeans(model2, pairwise ~ Treatments | Species, adjust = "tukey")
emmeans(model2, pairwise ~ Treatments * Species, adjust = "tukey")
####################################################################################################################################

#####################################################################################################################################
# Gamma Distribution on Filtered Data
#####################################################################################################################################

model3 <- glmmTMB(Avg_Measurement ~ Species * Treatments + 
                    (1 | Dose:Treatments) + (1 | Species:Dose:Treatments), 
                  data = Fungicide_filtered, 
                  family = Gamma(link = "log"))

# ANOVA Table
summary(model3)

car::Anova(model3, type = 3)

# Pairwise Comparisons (Tukey-adjusted)
emmeans(model3, pairwise ~ Treatments, adjust = "tukey")
emmeans(model1, pairwise ~ Species, adjust = "tukey")
emmeans(model3, pairwise ~ Treatments | Species, adjust = "tukey")
emmeans(model3, pairwise ~ Treatments * Species, adjust = "tukey")
####################################################################################################################################


######################################################################################################################################################
#Zero-Inflated Gamma Model
########################################################################################################################################
#Fungicide_Data$Species <- factor(Fungicide_Data$Species, levels = c("Fusarium oxysporum", "Diaporthe longicolla", 
#                                                                    "Fusarium solani", "Rhizoctonia solani"))

Fungicide_Data$Treatments <- factor(Fungicide_Data$Treatments, levels = c("DelaroComplete 3 active ingr (Proth+Trif+Fluop)", "Endura 1 active ingr (Boscalid)", 
                                                                          "Quadris 1 active ingr (Azoxystrobin)", "Topguard 1 active ingr (Flutriafol)", "Topguard EQ 2 active ingr (Flut+Azoxys)"))
zigamma_model <- glmmTMB(Avg_Measurement ~ Species * Treatments + (1 | Dose:Treatments) +(1 | Species:Dose:Treatments),  
                         family = ziGamma(link = "log"), 
                         ziformula = ~ 1, 
                         data = Fungicide_Data)
summary(zigamma_model)



# zigamma_model2 <- glmmTMB(Avg_Measurement ~ Species * Treatments + (1 | Dose:Treatments) + (1 | Species:Dose:Treatments),
#                           family = ziGamma(link = "log"), 
#                           ziformula = ~ Species + Treatments, 
#                           data = Fungicide_Data)
# summary(zigamma_model2)
# 
# 
# zigamma_model3 <- glmmTMB(Avg_Measurement ~ Species * Treatments + (1 | Dose:Treatments) +(1 | Species:Dose:Treatments),  
#                          family = ziGamma(link = "log"), 
#                          ziformula = ~ Species + Treatments + (1 | Dose:Treatments), 
#                          data = Fungicide_Data)
# 
# # Summary of the Model
# summary(zigamma_model3)

# anova(zigamma_model, zigamma_model2,zigamma_model3,zigamma_model4, test = "Chisq")

car::Anova(zigamma_model, type = 3)

library(parameters)
model_parameters(zigamma_model, exponentiate = T)


library(emmeans)

#Simple effects

calc.est1 <- emmeans(zigamma_model, ~Species * Treatments, type="response")

calc.est1

contrast(calc.est1)


# Convert to data frame
emm_df <- as.data.frame(calc.est1)

emm_focus <- emm_df %>%
  filter(Species == "Fusarium oxysporum" & 
           Treatments %in% c("Quadris 1 active ingr (Azoxystrobin)", "Topguard 1 active ingr (Flutriafol)", "Topguard EQ 2 active ingr (Flut+Azoxys)"))

ggplot(emm_focus, aes(x = Treatments, y = response)) +
  geom_point(size = 3, color = "darkblue") +
  geom_errorbar(aes(ymin = asymp.LCL, ymax = asymp.UCL), width = 0.2, color = "darkblue") +
  geom_line(aes(group = 1), color = "darkblue") +
  theme_minimal(base_size = 13) +
  labs(
    title = "Interaction Plot",
    x = "Treatment",
    y = "Estimated Average Growth (response scale)"
  )


#Pairwise differences
test.info1<- contrast(calc.est1, method="pairwise", type="response")
test.info1


# Extract the summary of pairwise contrasts
test.info1_summary <- summary(test.info1)

# Filter significant results (p-value < 0.05)
significant_results <- test.info1_summary[test.info1_summary$p.value < 0.05, ]

# Significant results
print(significant_results)

conf <- confint(test.info1, adjust="tukey", level=0.95)

# Filter only for significant comparisons
conf_significant <- conf[conf$contrast %in% significant_results$contrast, ]

# Print the filtered confidence intervals
print(conf_significant)

# Extract BLUPs (random effects)
blup_results <- ranef(zigamma_model)

# View the random effects
print(blup_results)

# Extract and prepare BLUPs
blup_df <- as.data.frame(blup_results$cond$`Dose:Treatments`)

blup_df$Group <- rownames(blup_df)
colnames(blup_df) <- c("BLUP", "Group")

# Sort for cleaner plotting
blup_df <- blup_df %>%
  arrange(BLUP) %>%
  mutate(Group = factor(Group, levels = Group),
         Category = ifelse(BLUP <= 0, "≤ 0", "> 0"))

# Forest plot with color
ggplot(blup_df, aes(x = BLUP, y = Group, color = Category)) +
  geom_point(size = 3) +
  scale_color_manual(values = c("≤ 0" = "red", "> 0" = "blue")) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "gray50") +
  theme_minimal(base_size = 11) +
  labs(
    title = "Forest Plot of BLUPs",
    x = "BLUP Estimate",
    y = "Group (Dose:Treatment)",
    color = "BLUP Value"
  )

# Extract and prepare BLUPs
blup_df <- as.data.frame(blup_results$cond$`Species:Dose:Treatments`)
blup_df$Group <- rownames(blup_df)
colnames(blup_df) <- c("BLUP", "Group")

# Separate the Group column into Species, Dose, and Treatments
blup_df <- blup_df %>%
  separate(Group, into = c("Species", "Dose", "Treatments"), sep = ":", remove = FALSE) %>%
  arrange(BLUP) %>%
  mutate(Group = factor(Group, levels = Group),
         Label = paste(Dose, Treatments, sep = ":"),
         Category = ifelse(BLUP <= 0, "≤ 0", "> 0"))

library(stringr)
# Remove text in parentheses from Label
blup_df <- blup_df %>%
  mutate(
    Label = str_remove(Label, "\\s*\\([^\\)]+\\)"),
    Label = str_trim(Label)
  )

# Forest plot faceted by Species, using Label without Species
ggplot(blup_df, aes(x = BLUP, y = Label, color = Category)) +
  geom_point(size = 3) +
  scale_color_manual(values = c("≤ 0" = "red", "> 0" = "blue")) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "gray50") +
  facet_wrap(~Species, scales = "free_y") +
  theme_minimal(base_size = 11) +
  labs(
    title = "Forest Plot of BLUPs by Species",
    x = "BLUP Estimate",
    y = "Dose:Treatment",
    color = "BLUP Value"
  )

# Prepare data
blup_df <- as.data.frame(blup_results$cond$`Species:Dose:Treatments`)
blup_df$Group <- rownames(blup_df)
colnames(blup_df) <- c("BLUP", "Group")

blup_df <- blup_df %>%
  separate(Group, into = c("Species", "Dose", "Treatments"), sep = ":", remove = FALSE) %>%
  mutate(
    Label = paste(Dose, Treatments, sep = ":"),
    Label = str_remove(Label, "\\s*\\([^\\)]+\\)"),
    Label = str_trim(Label),
    Category = ifelse(BLUP <= 0, "≤ 0", "> 0")
  )

# Function to create individual plots
plot_species_blup <- function(species_name, data) {
  data_species <- data %>%
    filter(Species == species_name) %>%
    mutate(Label = fct_reorder(Label, BLUP, .desc = FALSE))
  
  ggplot(data_species, aes(x = BLUP, y = Label, color = Category)) +
    geom_point(size = 3) +
    scale_color_manual(values = c("≤ 0" = "red", "> 0" = "blue")) +
    geom_vline(xintercept = 0, linetype = "dashed", color = "gray50") +
    theme_minimal(base_size = 11) +
    labs(
      title = species_name,
      x = "BLUP Estimate",
      y = "Dose:Treatment",
      color = "BLUP Value"
    )
}

# List of species
species_list <- unique(blup_df$Species)

# Create plots for each species
plots <- lapply(species_list, plot_species_blup, data = blup_df)

# Combine using patchwork
combined_plot <- wrap_plots(plots, ncol = 2) +
  plot_annotation(title = "Forest Plot of BLUPs by Species")

# Show plot
print(combined_plot)


######################################################################################################################################

########################################## Model Fit for Zero-Inflated ################################################################
library(DHARMa)
sim_res <- simulateResiduals(zigamma_model)
plot(sim_res)  

resid_plot <- plotResiduals(sim_res, form = Fungicide_Data$Avg_Measurement)
testDispersion(sim_res)


# Extract residuals and fitted values
library(lmtest)
bp_test <- bptest(zigamma_model)
print(bp_test) #Heteroscedasticity  detected

VarCorr(zigamma_model)
testZeroInflation(sim_res)

```
